doctype html
html
     head
          meta(charset='utf-8')
          title Личный кабинет
          // BOOTSTRAP
          script(src='http://code.jquery.com/jquery-latest.js')
          script(src='/resources/scripts/bootstrap.js')
          link(href='/resources/stylesheets/bootstrap.min.css', rel='stylesheet')
          link(rel='shortcut icon', href='/resources/img/favicon.png', type="image/png")
          script(src='http://code.jquery.com/jquery-latest.js')
          script(src='/resources/scripts/jquery-1.9.1.js')
          script(src='/resources/scripts/bootstrap.js')
          script(src='/resources/scripts/useDiscountValidation.js')
          link(href='/resources/stylesheets/bootstrap.min.css', rel='stylesheet')
          script(src='/resources/scripts/modernizr.custom.js')
          script(src='/resources/scripts/useValidator.js')
          link(rel='stylesheet', type='text/css', href='/resources/stylesheets/normalize.css')
          link(rel='stylesheet', type='text/css', href='/resources/stylesheets/component.css')
          link(rel='stylesheet', type='text/css', href='/resources/stylesheets/ajaxstyle.css')
          link(rel='stylesheet', type='text/css', href='/resources/stylesheets/content.css')
          meta(name="_csrf", content="#{_csrf.token}")
          meta(name="_csrf_header", content="#{_csrf.headerName}")
          // BOOTSTRAP END
          link(href='/resources/stylesheets/header.css', rel='stylesheet')
          link(href='/resources/stylesheets/style.css', rel='stylesheet')
          link(href='/resources/stylesheets/storestyle.css', rel='stylesheet')
     body
          // HEADER
          .header_container
               .header
                    a(href='homepage')
                         .header-image
                              img(src="/resources/img/logoOS.png")
                    .header-buttons
                         .log-button.morph-button.morph-button-modal.morph-button-modal-2.morph-button-fixed
                              form(action="/logout", method="post")
                                   input(type="hidden", name="#{_csrf.parameterName}", value="#{_csrf.token}")
                                   input.exit-button(type='submit', value='Выход')
                         // morph-button
                         #js_info_button.info-button(tabindex='1')
                              | Информация
                              ul.dropdown
                                   li
                                        a(href="settings") Настройки
                                   li
                                        a(href='about') О проекте
                                   li
                                        a(href='developers') Разработчики
                                   li
                                        a(href='feedback') Поддержка
          // HEADER END
          // MAIN
          .main
               // <div class="homepage_describe">123</div>
               .generation-repayment-container
                    .tabs
                         ul.nav.nav-pills
                              li.active
                                   a(data-toggle='tab', href='#repaymentSection') Использовать скидку
                              li
                                   a(data-toggle='tab', href='#generateSection') Сгенерировать скидки
                    .tab-content
                         #repaymentSection.repayment-block.tab-pane.fade.in.active
                              .registration-form
                                   h2.reg-fill-heading ИСПОЛЬЗОВАТЬ СКИДКУ
                                   .js-use
                                        form#js-use-form(action="/use_discount", method="post")
                                             .reg-input-lable-container
                                                  .infoBlock
                                                  input(type="hidden", name="#{_csrf.parameterName}", value="#{_csrf.token}")
                                                  label.reglable Введите ключ скидки
                                                  input.generate-input.key_input(type='text', name="key")
                                                  .errors#keyError
                                                  input.form-control.registration-button.yes.reginp(type='submit', value='ИСПОЛЬЗОВАТЬ')

                         #generateSection.generate-discount-block.tab-pane.fade
                              .registration-form
                                   h2.reg-fill-heading ГЕНЕРАЦИЯ СКИДКИ
                                   form(action="/generate_discount", method="post")
                                        .reg-input-lable-container
                                             input(type="hidden", name="#{_csrf.parameterName}", value="#{_csrf.token}")
                                             label.reglable Наименование магазина
                                             input.form-control.not-morph(name='storeName', type='text', readonly='', onkeydown="event.preventDefault()", value="#{store.storeName}")
                                             label.reglable Введите % скидки
                                             input.form-control.not-morph(name='discountPercent', type='text', value="#{store.discountPercent}")
                                             label.reglable Введите Email покупателя
                                             input.form-control.not-morph(type='text', name='userName')
                                             label.reglable Введите описание скидки
                                             textarea.generate-textarea(name="description",type='text') #{store.description}
                                             input.form-control.registration-button.yes.reginp(type='submit', value='СГЕНЕРИРОВАТЬ')


               // MAIN END
               // SCRIPTS
               script(src='/resources/scripts/classie.js')
               script(src='/resources/scripts/uiMorphingButton_fixed.js')
               script.
                    (function () {
                         var docElem = window.document.documentElement, didScroll, scrollPosition;
                         // trick to prevent scrolling when opening/closing button
                         function noScrollFn() {
                              window.scrollTo(scrollPosition ? scrollPosition.x : 0, scrollPosition ? scrollPosition.y : 0);
                         }

                         function noScroll() {
                              window.removeEventListener('scroll', scrollHandler);
                              window.addEventListener('scroll', noScrollFn);
                         }

                         function scrollFn() {
                              window.addEventListener('scroll', scrollHandler);
                         }

                         function canScroll() {
                              window.removeEventListener('scroll', noScrollFn);
                              scrollFn();
                         }

                         function scrollHandler() {
                              if (!didScroll) {
                                   didScroll = true;
                                   setTimeout(function () {
                                        scrollPage();
                                   }, 60);
                              }
                         };
                         function scrollPage() {
                              scrollPosition = {
                                   x: window.pageXOffset || docElem.scrollLeft,
                                   y: window.pageYOffset || docElem.scrollTop
                              };
                              didScroll = false;
                         };
                         scrollFn();
                         [].slice.call(document.querySelectorAll('.morph-button')).forEach(function (bttn) {
                              new UIMorphingButton(bttn, {
                                   closeEl: '.icon-close',
                                   onBeforeOpen: function () {
                                        // don't allow to scroll
                                        noScroll();
                                   },
                                   onAfterOpen: function () {
                                        // can scroll again
                                        canScroll();
                                   },
                                   onBeforeClose: function () {
                                        // don't allow to scroll
                                        noScroll();
                                   },
                                   onAfterClose: function () {
                                        // can scroll again
                                        canScroll();
                                   }
                              });
                         });
                         [].slice.call(document.querySelectorAll('.morph-button')).forEach(function (bttn) {
                              new UIMorphingButton(bttn, {
                                   closeEl: '.no',
                                   onBeforeOpen: function () {
                                        // don't allow to scroll
                                        noScroll();
                                   },
                                   onAfterOpen: function () {
                                        // can scroll again
                                        canScroll();
                                   },
                                   onBeforeClose: function () {
                                        // don't allow to scroll
                                        noScroll();
                                   },
                                   onAfterClose: function () {
                                        // can scroll again
                                        canScroll();
                                   }
                              });
                         });
                         // for demo purposes only
                         [].slice.call(document.querySelectorAll('form button')).forEach(function (bttn) {
                              bttn.addEventListener('click', function (ev) {
                                   ev.preventDefault();
                              });
                         });
                    })();
               script.
                    $(function () {
                         $('#myTabExample a:first').tab('show')
                    });
               script(type='text/javascript').
                    function DropDown(el) {
                         this.dd = el;
                         this.initEvents();
                    }
                    DropDown.prototype = {
                         initEvents: function () {
                              var obj = this;
                              obj.dd.on('click', function (event) {
                                   $(this).toggleClass('active');
                                   event.stopPropagation();
                              });
                         }
                    }
                    $(function () {
                         var js_info_button = new DropDown($('#js_info_button'));
                         $(document).click(function () {
                              // all dropdowns
                              $('.info-button').removeClass('active');
                         });
                    });
               // SCRIPTS
